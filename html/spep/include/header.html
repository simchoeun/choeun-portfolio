<div class="content_wrap">
  <a href="javascript:void(0)" title="메인페이지 바로가기" class="logo">
    <img src="/html/spep/assets/images/icon/logo.png" alt="">
  </a>
  <nav>
    <ul>
      <li>
        <a href="/html/spep/index_student.html" title="" class="depth1">Home</a>
      </li>
      <li>
        <a href="/html/spep/html/class/class_room.html" title="" class="depth1">Mobile Learning</a>
        <ul class="sub_menu">
          <li><a href="/html/spep/html/class/class_room.html" title="모바일러닝 액티비티" class="depth2">모바일러닝 액티비티</a></li>
          <li><a href="/html/spep/html/class/class_room.html" title="What’s New" class="depth2">What’s New</a></li>
          <li><a href="/html/spep/html/class/class_room.html" title="마이리스트" class="depth2">마이리스트</a></li>
        </ul>
      </li>
      <li>
        <a href="javascript:void(0)" title="" class="depth1">Class</a>
        <ul class="sub_menu">
          <li><a href="/html/spep/html/class/class_room.html" title="클래스룸" class="depth2">클래스룸</a></li>
          <li><a href="/html/spep/html/class/class_room.html" title="수강신청" class="depth2">수강신청</a></li>
          <li><a href="/html/spep/html/class/class_room.html" title="히스토리" class="depth2">히스토리</a></li>
          <li><a href="/html/spep/html/class/class_room.html" title="Survey" class="depth2">Survey</a></li>
        </ul>
      </li>
      <li>
        <a href="/html/spep/html/class/class_room.html" title="" class="depth1">Chat</a>
      </li>
    </ul>
  </nav>
  <div class="info_wrap">
    <!-- 새 알람이 있을경우 new 클래스 추가 -->
    <!-- pc에서는 alarm_box가 나와야하지만 mobile에서는 링크이동 -->
    <button type="button" class="mo_hidden alarm new">
      <img src="/html/spep/assets/images/icon/ic_alarm.svg" alt="">
    </button>
    <a href="javascript:void(0)" class="pc_hidden alarm new">
      <img src="/html/spep/assets/images/icon/ic_alarm.svg" alt="">
    </a>
    <div class="alarm_box">
      <div class="top_wrap">
        <p class="alarm_tit">알림</p>
        <button type="button" class="btn_close"></button>
      </div>
      <div class="bottom_wrap">
        <div class="date_box">
          <p class="date_tit">오늘</p>
          <div class="alarm_detail">
            <a href="javascript:void(0)" class="btn_alaram_detail">
              <span class="ic_checkbox"></span>
              <span class="txt_wrap">
                <span class="tit">2025년 2월 출석률 100% 달성!</span>
                <span class="date">1시간 전</span>
              </span>
            </a>
          </div>
          <div class="alarm_detail checked">
            <a href="javascript:void(0)" class="btn_alaram_detail">
              <span class="ic_checkbox"></span>
              <span class="txt_wrap">
                <span class="tit">2025년 2월 출석률 100% 달성!</span>
                <span class="date">1시간 전</span>
              </span>
            </a>
          </div>
        </div>
        <div class="date_box">
          <p class="date_tit">2025년 3월 23일</p>
          <div class="alarm_detail ">
            <a href="javascript:void(0)" class="btn_alaram_detail">
              <span class="ic_checkbox"></span>
              <span class="txt_wrap">
                <span class="tit">2025년 2월 출석률 100% 달성!</span>
                <span class="date">2025-3-23</span>
              </span>
              <span class="ic_arrow"></span>
            </a>
          </div>
          <div class="alarm_detail checked">
            <a href="javascript:void(0)" class="btn_alaram_detail">
              <span class="ic_checkbox"></span>
              <span class="txt_wrap">
                <span class="tit">2025년 2월 출석률 100% 달성!</span>
                <span class="date">2025-3-23</span>
              </span>
              <span class="ic_arrow"></span>
            </a>
          </div>
          <div class="alarm_detail checked">
            <a href="javascript:void(0)" class="btn_alaram_detail">
              <span class="ic_checkbox"></span>
              <span class="txt_wrap">
                <span class="tit">2025년 2월 출석률 100% 달성!</span>
                <span class="date">2025-3-23</span>
              </span>
              <span class="ic_arrow"></span>
            </a>
          </div>
          <div class="alarm_detail checked">
            <a href="javascript:void(0)" class="btn_alaram_detail">
              <span class="ic_checkbox"></span>
              <span class="txt_wrap">
                <span class="tit">2025년 2월 출석률 100% 달성!</span>
                <span class="date">2025-3-23</span>
              </span>
              <span class="ic_arrow"></span>
            </a>
          </div>
          <div class="alarm_detail checked">
            <a href="javascript:void(0)" class="btn_alaram_detail">
              <span class="ic_checkbox"></span>
              <span class="txt_wrap">
                <span class="tit">2025년 2월 출석률 100% 달성!</span>
                <span class="date">2025-3-23</span>
              </span>
              <span class="ic_arrow"></span>
            </a>
          </div>
          <div class="alarm_detail checked">
            <a href="javascript:void(0)" class="btn_alaram_detail">
              <span class="ic_checkbox"></span>
              <span class="txt_wrap">
                <span class="tit">2025년 2월 출석률 100% 달성!</span>
                <span class="date">2025-3-23</span>
              </span>
              <span class="ic_arrow"></span>
            </a>
          </div>
        </div>
        <button type="button" class="btn_alarm_more">더보기</button>
      </div>
    </div>
    <button type="button" class="info_btn">
      <a href="javascript:void(0)" class="thumbnail"><img src="/html/spep/assets/images/icon/ic_user.svg" alt=""></a>
      <span class="user_name">홍길동님</span>
      <span class="triangle"><img src="/html/spep/assets/images/icon/ic_triangle.svg" alt=""></span>
    </button>
    <div class="info_detail">
      <div class="top_wrap">
        <div class="user">
          <p class="thumbnail"><img src="/html/spep/assets/images/icon/ic_user.svg" alt=""></p>
          <p class="user_name">홍길동님</p>
        </div>
        <div class="point_wrap">
          <p class="txt">
            <img src="/html/spep/assets/images/icon/ic_point.svg" alt="">
            포인트
          </p>
          <p class="point">3,400,930P</p>
        </div>
      </div>
      <ul class="link_list">
        <li>
          <a href="javascript:void(0)" title="나의 강의">나의 강의</a>
        </li>
        <li>
          <a href="javascript:void(0)" title="공지사항">공지사항</a>
          <a href="javascript:void(0)" title="FAQ">FAQ</a>
          <a href="javascript:void(0)" title="1:1 문의">1:1 문의</a>
        </li>
        <li>
          <a href="javascript:void(0)" title="회원 정보 수정">회원 정보 수정</a>
          <a href="javascript:void(0)" title="비밀번호 변경">비밀번호 변경</a>
        </li>
        <li>
          <a href="javascript:void(0)" title="로그아웃" class="logout">
            <img src="/html/spep/assets/images/icon/ic_logout.svg" alt="">
            로그아웃
          </a>
        </li>
      </ul>
    </div>
  </div>

  <button type="button" class="btn_menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <div class="mo_menu_wrap">
    <div class="top_wrap">
      <div class="user_wrap">
        <div class="thumbnail"></div>
        <!-- 로그인 후 : 해당되는것에 active클래스 부여 -->
        <div class="user_info active">
          <p class="user_name">홍길동님</p>
          <p class="info">
            <span>현대차/기아</span>
            <span>20240518001</span>
          </p>
        </div>
        <!-- 로그인 전 : 해당되는것에 active클래스 부여 -->
        <div class="login_required">
          <a href="javascript:void(0)" title="로그인을 해주세요" class="btn_menu_login">
            로그인을 해주세요
          </a>
          <p class="login_info_txt">SPEP 수강하려면 로그인이 필요합니다.</p>
        </div>
      </div>
      <div class="point_box">
        <p class="point_txt">포인트</p>
        <p class="point">30,000</p>
      </div>
    </div>
    <div class="scroll_box">
      <ul class="nav_list">
        <li>
          <button type="button" class="btn_depth1">모바일러닝</button>
          <ul class="depth2_wrap">
            <li>
              <a href="/html/spep/html/class/class_room.html" title="학습하기">학습하기</a>
            </li>
            <li>
              <a href="/html/spep/html/class/class_room.html" title="What’s new">What’s new</a>
            </li>
            <li>
              <a href="/html/spep/html/class/class_room.html" title="마이리스트">마이리스트</a>
            </li>
          </ul>
        </li>
        <li>
          <button type="button" class="btn_depth1">클래스</button>
          <ul class="depth2_wrap">
            <li>
              <a href="/html/spep/html/class/class_room.html" title="클래스룸">클래스룸</a>
            </li>
            <li>
              <a href="/html/spep/html/class/class_room.html" title="수강신청">수강신청</a>
            </li>
            <li>
              <a href="/html/spep/html/class/class_room.html" title="히스토리">히스토리</a>
            </li>
            <li>
              <a href="/html/spep/html/class/class_room.html" title="Survey">Survey</a>
            </li>
          </ul>
        </li>
        <li>
          <a href="/html/spep/html/class/class_room.html" title="채팅" class="btn_depth1 no_arrow">채팅</a>
        </li>
      </ul>
      <ul class="nav_list">
        <p class="nav_desc">마이페이지</p>
        <li>
          <a href="javascript:void(0)" title="나의 강의" class="btn_depth1 no_arrow">나의 강의</a>
        </li>
        <li>
          <button type="button" class="btn_depth1">고객센터</button>
          <ul class="depth2_wrap">
            <li>
              <a href="/html/spep/html/class/class_room.html" title="공지사항">공지사항</a>
            </li>
            <li>
              <a href="/html/spep/html/class/class_room.html" title="FAQ">FAQ</a>
            </li>
            <li>
              <a href="/html/spep/html/class/class_room.html" title="1:1 문의">1:1 문의</a>
            </li>
          </ul>
        </li>
        <li>
          <button type="button" class="btn_depth1">내정보</button>
          <ul class="depth2_wrap">
            <li>
              <a href="javascript:void(0)" title="회원 정보 수정">회원 정보 수정</a>
            </li>
            <li>
              <a href="javascript:void(0)" title="비밀번호 변경">비밀번호 변경</a>
            </li>
          </ul>
        </li>
      </ul>
    </div>
    <button type="button" class="btn_loginout">
      로그아웃
      <!-- 로그인 -->
    </button>
  </div>
</div>

<script>
  const currentPage = window.location.pathname.split('/').pop();
  const navLinks = document.querySelectorAll('#header nav ul li a.depth1');

  // if (currentPage === 'index.html' || currentPage === 'index_student.html' || currentPage === '') {
  //   if(navLinks[0]) {
  //     navLinks[0].classList.add('active');
  //   }
  // } else if (window.location.pathname.includes('/mobileLearning/')) {
  //   navLinks.forEach(link => link.classList.remove('active')); 
  //   if (navLinks[1]) {
  //     navLinks[1].classList.add('active');
  //   } 
  // }  else if (window.location.pathname.includes('/class/')) {
  //   navLinks.forEach(link => link.classList.remove('active')); 
  //   if (navLinks[2]) {
  //     navLinks[2].classList.add('active');
  //   } 
  // } else if (window.location.pathname.includes('/chat/')) {
  //   navLinks.forEach(link => link.classList.remove('active')); 
  //   if (navLinks[3]) {
  //     navLinks[3].classList.add('active');
  //   } 
  // } else {
  //   navLinks.forEach(link => link.classList.remove('active'));
  // }

  // 유저 닉네임 클릭 시
  const infoBtn = document.querySelector(".info_btn");
  const infoDetail = document.querySelector(".info_detail");

  infoBtn.addEventListener("click", function (event) {
    // thumbnail을 클릭한 경우엔 무시
    if (event.target.closest(".info_btn .thumbnail")) return;

    event.stopPropagation();
    infoDetail.classList.toggle("active");
  });

  // 문서 전체 클릭 시 info_detail 닫기
  document.addEventListener("click", function (event) {
    if (!infoBtn.contains(event.target) && !infoDetail.contains(event.target)) {
      infoDetail.classList.remove("active");
    }
  });


  // gnb hover
  const gnbHover = () => {
    const depth1MenuItems = document.querySelectorAll('.depth1');
    const header = document.querySelector('header');
    const menuItems = document.querySelectorAll('nav > ul > li');

    const checkScreenWidth = () => {
      // 768px 이하일 때 hover 클래스를 없애기
      if (window.innerWidth <= 768) {
        header.classList.remove('hover');
        menuItems.forEach(item => item.classList.remove('active'));
      } else {
        depth1MenuItems.forEach(item => {
          item.addEventListener('mouseenter', () => {
            header.classList.add('hover');
          });

          header.addEventListener('mouseleave', () => {
            header.classList.remove('hover');
          });
        });

        menuItems.forEach(item => {
          item.addEventListener('mouseenter', () => {
            menuItems.forEach(i => i.classList.remove('active'));
            item.classList.add('active');
          });

          item.addEventListener('mouseleave', () => {
            item.classList.remove('active');
          });
        });
      }
    };

    // 화면 크기 체크
    checkScreenWidth();

    // 윈도우 크기 변경 시 다시 체크
    window.addEventListener('resize', checkScreenWidth);
  };

  gnbHover();

  // 알람버튼
  const alarm = () => {
    const alarmBtn = document.querySelector(".alarm");
    const alarmBox = document.querySelector(".alarm_box");
    const closeBtn = document.querySelector(".alarm_box .btn_close");
    const header = document.querySelector("#header");

    alarmBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      alarmBox.classList.toggle("active");

      if (header) {
        header.classList.add("open_alarm");
        if (header.classList.contains("open_alarm")) {
          document.body.style.overflow = "hidden";
        } else {
          document.body.style.overflow = "";
        }
      }
    });


    alarmBox.addEventListener("click", (e) => {
      e.stopPropagation();
    });

    closeBtn.addEventListener("click", () => {
      alarmBox.classList.remove("active");
      if (header) {
        header.classList.remove("open_alarm");
        if (header.classList.contains("open_alarm")) {
          document.body.style.overflow = "hidden";
        } else {
          document.body.style.overflow = "";
        }
      }
    });

    document.addEventListener("click", () => {
      alarmBox.classList.remove("active");
      if (header) {
        header.classList.remove("open_alarm");
        if (header.classList.contains("open_alarm")) {
          document.body.style.overflow = "hidden";
        } else {
          document.body.style.overflow = "";
        }
      }
    });
  }
  alarm();


  // mobile 메뉴 햄버거 클릭 시
  const btnMenu = document.querySelector(".btn_menu");
  const moMenuWrap = document.querySelector(".mo_menu_wrap");

  btnMenu.addEventListener("click", function () {
    this.classList.toggle("active");
    moMenuWrap.classList.toggle("active");

    const header = document.querySelector("#header");
    if (header) {
      header.classList.toggle("active");
    }

    // body 스크롤 막기 / 허용
    if (moMenuWrap.classList.contains("active")) {
      document.body.style.overflow = "hidden"; 
      document.body.style.position = "fixed";
      document.body.style.width = "100%";
    } else {
      document.body.style.overflow = "";
      document.body.style.position = "";
      document.body.style.width = "";
    }
  });

  // 모바일 메뉴 클릭 시
  const depth1Buttons = document.querySelectorAll(".btn_depth1");

  depth1Buttons.forEach(button => {
    button.addEventListener("click", function (event) {
      event.preventDefault();

      const isActive = this.classList.contains("active");

      // 모든 버튼 및 메뉴 비활성화
      depth1Buttons.forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll(".depth2_wrap").forEach(menu => menu.classList.remove("active"));

      // 클릭한 버튼과 해당 서브 메뉴만 활성화
      if (!isActive) {
        this.classList.add("active"); 
        const menu = this.nextElementSibling; 
        if (menu && menu.classList.contains("depth2_wrap")) {
          menu.classList.add("active"); 
        }
      }
    });
  });

  // 모바일 환경에서도 동작하도록 touch 이벤트 추가
  depth1Buttons.forEach(button => {
    button.addEventListener("touchstart", function (event) {
      event.preventDefault(); 
      this.click();
    });
  });

  // vh 대응
  const setVh = () => {
    const vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
  };

  setVh();
  window.addEventListener('resize', setVh);
</script>
